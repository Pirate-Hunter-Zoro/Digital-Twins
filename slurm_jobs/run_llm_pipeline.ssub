#!/bin/bash

#SBATCH --job-name=LIBR_Main_Pipeline # A descriptive name for your main pipeline job
#SBATCH --partition=c3                # Specify the partition
#SBATCH --ntasks=1                    # Request 1 task (your main Python script)
#SBATCH --cpus-per-task=96            # Request enough CPU cores for your multiprocessing in main.py
#SBATCH --mem=128G                    # Request RAM for main.py (patient data, processing)
#SBATCH --time=24:00:00               # Max wall-time for your pipeline (e.g., 24 hours)
#SBATCH --output=logs/LIBR_Main_Pipeline_%j.stdout # Standard output log
#SBATCH --error=logs/LIBR_Main_Pipeline_%j.stderr   # Standard error log file
#SBATCH --nodelist=compute301

# --- Environment Setup ---
module load Python/3.11.5-GCCcore-13.2.0 # Use the available Python module
# NEW: Use the precise, absolute path you found for your environment activation
source /home/librad.laureateinstitute.org/mferguson/.conda/envs/vllm_env/bin/activate

# --- Navigate to your project directory ---
cd /mnt/dell_storage/homefolders/librad.laureateinstitute.org/mferguson/Digital-Twins/

# --- Run your Python script ---
python scripts/main.py

conda deactivate